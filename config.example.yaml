# cmd2ai Configuration File
# This file configures AI model settings, local tools, and MCP (Model Context Protocol) servers

# Global Tools Configuration
tools:
  # Enable or disable all tools (both local and MCP)
  # When false, disables all tools regardless of per-section settings
  enabled: true

# Local Tools Configuration
# Built-in tools that run directly in cmd2ai (no external processes)
local_tools:
  # Enable local tools
  enabled: true
  
  # Base directory for file operations (defaults to $HOME)
  # Supports environment variable expansion: ${HOME}, ${USER}, etc.
  base_dir: ${HOME}
  
  # Maximum file size for read_file tool (in MB)
  max_file_size_mb: 10
  
  # Per-tool configuration (optional)
  # If a tool is not listed here, it defaults to enabled
  tools:
    # Built-in tools (just enable/disable)
    - name: echo
      enabled: true
    - name: time_now
      enabled: true
    - name: read_file
      enabled: true
    - name: list_dir
      enabled: true
    
    # Custom script-based tool (inline Python)
    - name: upper
      enabled: true
      type: script
      description: "Convert text to uppercase"
      interpreter: python3
      script: |
        import sys, json
        data = json.load(sys.stdin)
        text = data.get("text", "")
        print(text.upper())
      input_schema:
        type: object
        properties:
          text:
            type: string
            description: "Text to convert to uppercase"
        required: [text]
        additionalProperties: false
      timeout_secs: 10
      max_output_bytes: 1048576
    
    # Custom command-based tool
    - name: word_count
      enabled: true
      type: command
      description: "Count words in text using wc command"
      command: wc
      args: ["-w"]
      input_schema:
        type: object
        properties:
          text:
            type: string
            description: "Text to count words in"
        required: [text]
        additionalProperties: false
      timeout_secs: 10
      max_output_bytes: 262144
    
    # Custom script from file
    # - name: my_script_tool
    #   enabled: true
    #   type: script
    #   description: "Run a custom script from file"
    #   interpreter: python3
    #   script_path: scripts/my_tool.py  # Relative to base_dir
    #   input_schema:
    #     type: object
    #     properties:
    #       input:
    #         type: string
    #     required: [input]
    #   timeout_secs: 30
    #   working_dir: scripts  # Optional: change working directory
    #   env:  # Optional: environment variables
    #     CUSTOM_VAR: ${HOME}/custom

# API Configuration
api:
  # Custom API endpoint (optional)
  # Default: https://openrouter.ai/api/v1
  # endpoint: https://api.openai.com/v1
  
  # Request timeout in seconds
  stream_timeout: 30

# Model Configuration
model:
  # Default AI model to use
  # Examples: openai/gpt-5, openai/gpt-4, anthropic/claude-3-opus
  default_model: openai/gpt-5
  
  # System prompt to prepend to all conversations (optional)
  # system_prompt: You are a helpful assistant.

# Session Configuration
session:
  # Enable verbose debug logging
  verbose: false

# Reasoning Configuration
# For models that support chain-of-thought reasoning
reasoning:
  # Enable reasoning by default
  enabled: false
  
  # Reasoning effort level: high, medium, or low
  effort: low
  
  # Maximum tokens for reasoning (optional)
  # max_tokens: 2000
  
  # Use reasoning internally but exclude from output
  exclude: false

# MCP (Model Context Protocol) Configuration
mcp:
  # Disable all MCP tools (can also use --no-mcp-tools flag)
  disable_tools: false
  
  # MCP Settings
  settings:
    # Automatically detect and activate relevant MCP servers based on query keywords
    # When enabled, only servers matching keywords in your query will be connected
    # When disabled, all enabled servers are connected (legacy behavior)
    auto_detect: true
    
    # Timeout for MCP operations in seconds
    timeout: 30
  
  # MCP Server Definitions
  servers:
    # Filesystem MCP Server
    - name: filesystem
      command: npx
      args: ["-y", "@modelcontextprotocol/server-filesystem", "/tmp"]
      description: File system operations
      # Keywords that trigger this server
      auto_activate_keywords:
        - file
        - files
        - directory
        - folder
        - read
        - write
        - create
        - delete
        - list
      enabled: true
    
    # Time MCP Server
    - name: time
      command: npx
      args: ["-y", "@modelcontextprotocol/server-time"]
      description: Time and date utilities
      auto_activate_keywords:
        - time
        - clock
        - current time
        - what time
        - date
        - today
        - tomorrow
        - yesterday
      enabled: true
    
    # GitHub MCP Server (disabled by default - requires GITHUB_TOKEN)
    - name: github
      command: npx
      args: ["-y", "@modelcontextprotocol/server-github"]
      description: GitHub API integration
      auto_activate_keywords:
        - github
        - repository
        - repo
        - issue
        - pull request
        - pr
        - commit
      # Environment variables for this server
      # Use ${VAR_NAME} syntax for expansion
      env:
        GITHUB_TOKEN: ${GITHUB_TOKEN}
      enabled: false
    
    # Web Browser MCP Server
    - name: web
      command: npx
      args: ["-y", "@modelcontextprotocol/server-web"]
      description: Web browsing and scraping
      auto_activate_keywords:
        - browse
        - website
        - webpage
        - url
        - fetch
        - scrape
        - web
        - http
      enabled: true
    
    # PostgreSQL MCP Server (disabled by default - requires DATABASE_URL)
    - name: postgres
      command: npx
      args: ["-y", "@modelcontextprotocol/server-postgres"]
      description: PostgreSQL database operations
      auto_activate_keywords:
        - database
        - sql
        - postgres
        - postgresql
        - query
        - table
        - select
        - insert
        - update
        - delete
      env:
        DATABASE_URL: ${DATABASE_URL}
      enabled: false
  
  # Tool Selection Configuration
  tool_selection:
    # Maximum number of MCP servers to activate for a single query
    # Only applies when auto_detect is enabled
    max_servers: 3
    
    # Minimum keyword match score (0.0 to 1.0)
    # Higher values require stronger keyword matches
    # Score is calculated as: (matched_keywords / total_keywords)
    # Example: If a server has 5 keywords and 2 match, score = 0.4
    min_match_score: 0.3
    
    # Prompt user before activating MCP servers (not yet implemented)
    prompt_before_activation: false