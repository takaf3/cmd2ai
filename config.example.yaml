# cmd2ai Configuration File
# This file configures AI model settings and local tools

# Global Tools Configuration
tools:
  # Enable or disable all tools
  # When false, disables all tools regardless of per-section settings
  enabled: true

# Local Tools Configuration
# Built-in tools that run directly in cmd2ai (no external processes)
local_tools:
  # Enable local tools
  enabled: true
  
  # Base directory for file operations (defaults to $HOME)
  # Supports environment variable expansion: ${HOME}, ${USER}, etc.
  base_dir: ${HOME}
  
  # Maximum file size for read_file tool (in MB)
  max_file_size_mb: 10
  
  # Per-tool configuration (optional)
  # If a tool is not listed here, it defaults to enabled
  tools:
    # Built-in tools (just enable/disable)
    - name: read_file
      enabled: true
    
    # Custom script-based tool (inline Python)
    - name: upper
      enabled: true
      type: script
      description: "Convert text to uppercase"
      interpreter: python3
      script: |
        import sys, json
        data = json.load(sys.stdin)
        text = data.get("text", "")
        print(text.upper())
      input_schema:
        type: object
        properties:
          text:
            type: string
            description: "Text to convert to uppercase"
        required: [text]
        additionalProperties: false
      timeout_secs: 10
      max_output_bytes: 1048576
    
    # Custom command-based tool
    - name: word_count
      enabled: true
      type: command
      description: "Count words in text using wc command"
      command: wc
      args: ["-w"]
      input_schema:
        type: object
        properties:
          text:
            type: string
            description: "Text to count words in"
        required: [text]
        additionalProperties: false
      timeout_secs: 10
      max_output_bytes: 262144
    
    # Command tool with argument templating
    # Use {{key}} syntax to inject tool arguments into command args
    # SECURITY: Path arguments are automatically validated and restricted to base_dir
    # The "--" separator is automatically inserted before templated path arguments
    # to prevent option injection attacks.
    - name: list_directory
      enabled: true
      type: command
      description: "List files in a directory using ls"
      command: ls
      args: ["-la", "{{path}}"]  # {{path}} will be replaced with the 'path' argument value
      # Security settings (all have secure defaults):
      restrict_to_base_dir: true  # Restrict path arguments to base_dir (default: true)
      insert_double_dash: true    # Insert "--" before templated args to prevent option injection (default: auto-detect)
      # stdin_json: false  # Optional: set to false to disable sending JSON via stdin (default: true)
      # Explicit validation policy (optional - path arguments are auto-detected)
      template_validations:
        path:
          kind: path
          allow_absolute: false  # Reject absolute paths (default: false)
          # deny_patterns: ["\\.\\./"]  # Optional: deny specific patterns
      input_schema:
        type: object
        properties:
          path:
            type: string
            description: "Path to the directory to list (relative to base_dir)"
        required: [path]
        additionalProperties: false
      timeout_secs: 10
      max_output_bytes: 262144
    
    # Example: Command tool with non-path templated arguments
    # For non-path arguments, you can use pattern validation
    - name: search_text
      enabled: true
      type: command
      description: "Search for text in files using grep"
      command: grep
      args: ["-r", "{{pattern}}", "{{directory}}"]
      template_validations:
        pattern:
          kind: string
          # Allow only alphanumeric and common regex characters
          allow_patterns: ["^[a-zA-Z0-9\\s\\-_.*+?()|]+$"]
        directory:
          kind: path  # Explicitly mark as path for validation
      input_schema:
        type: object
        properties:
          pattern:
            type: string
            description: "Search pattern"
          directory:
            type: string
            description: "Directory to search in (relative to base_dir)"
        required: [pattern, directory]
        additionalProperties: false
      timeout_secs: 10
      max_output_bytes: 262144
    
    # Custom script from file
    # - name: my_script_tool
    #   enabled: true
    #   type: script
    #   description: "Run a custom script from file"
    #   interpreter: python3
    #   script_path: scripts/my_tool.py  # Relative to base_dir
    #   input_schema:
    #     type: object
    #     properties:
    #       input:
    #         type: string
    #     required: [input]
    #   timeout_secs: 30
    #   working_dir: scripts  # Optional: change working directory
    #   env:  # Optional: environment variables
    #     CUSTOM_VAR: ${HOME}/custom

# API Configuration
api:
  # Custom API endpoint (optional)
  # Default: https://openrouter.ai/api/v1
  # endpoint: https://api.openai.com/v1
  
  # Request timeout in seconds
  stream_timeout: 30

# Model Configuration
model:
  # Default AI model to use
  # Examples: openai/gpt-5, openai/gpt-4, anthropic/claude-3-opus
  default_model: openai/gpt-5
  
  # System prompt to prepend to all conversations (optional)
  # system_prompt: You are a helpful assistant.

# Session Configuration
session:
  # Enable verbose debug logging
  verbose: false

# Reasoning Configuration
# For models that support chain-of-thought reasoning
reasoning:
  # Enable reasoning by default
  enabled: false
  
  # Reasoning effort level: high, medium, or low
  effort: low
  
  # Maximum tokens for reasoning (optional)
  # max_tokens: 2000
  
  # Use reasoning internally but exclude from output
  exclude: false